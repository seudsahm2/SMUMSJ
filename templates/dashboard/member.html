{% extends "base/base.html" %}
{% load static %}
{% load humanize %}
{% load charity_tags %}
{% load hijri_tags %}

{% block title %}St. Mary's Muslim Jama{% endblock %}

{% block content %}
<!-- Preloader Spinner Start -->

<!-- Preloader Spinner End -->

<!-- Hero Section Start -->
<section class="hero-header">
  <div class="hero-overlay"></div> <!-- Dark overlay for readability -->
  <div class="hero-content container">
    <p class="fs-4">Assalamu Alaikum</p>
    <h1 class="display-1">St. Mary's Muslim Jama</h1>
    <!-- Date Card with light background and rounded corners -->
    <div class="bg-light p-3 rounded d-inline-block">
      <div class="hijri-text text-primary fw-bold">
        {{ current_date|hijri_date }}
      </div>
      <div class="gregorian-text text-muted">
        {{ current_date|date:"F j, Y" }}
      </div>
    </div>
  </div>
</section>
<!-- Hero Section End -->

<!-- Quick Actions Section Start -->
<section class="py-5">
  <div class="container">
    <div class="row g-4 text-center">
      <!-- Upcoming Events Action -->
      <div class="col-md-6 col-lg-3">
        <div class="p-4 border rounded shadow-sm">
          <i class="fas fa-calendar-alt fa-3x mb-3" style="color: #2A5A3B;"></i>
          <h4>Upcoming Events</h4>
          <p>{{ upcoming_events.count }} events scheduled</p>
          <a href="{% url 'events:event-list' %}" class="btn btn-custom">View All</a>
        </div>
      </div>
      <!-- Charity Progress Action -->
      <div class="col-md-6 col-lg-3">
        <div class="p-4 border rounded shadow-sm">
          <i class="fas fa-hand-holding-heart fa-3x mb-3" style="color: #2A5A3B;"></i>
          <h4>Charity Progress</h4>
          <p>{{ active_campaigns.count }} active campaigns</p>
          <a href="{% url 'charity:campaigns' %}" class="btn btn-custom">Donate Now</a>
        </div>
      </div>
      <!-- Learning Resources Action -->
      <div class="col-md-6 col-lg-3">
        <div class="p-4 border rounded shadow-sm">
          <i class="fas fa-book-open fa-3x mb-3" style="color: #2A5A3B;"></i>
          <h4>Learning Resources</h4>
          <p>{{ resource_count }} available resources</p>
          <a href="{% url 'resources:resource-list' %}" class="btn btn-custom">Explore</a>
        </div>
      </div>
      <!-- Prayer Times Action -->
      <div class="col-md-6 col-lg-3">
        <div class="p-4 border rounded shadow-sm">
          <i class="fas fa-pray fa-3x mb-3" style="color: #2A5A3B;"></i>
          <h4>Prayer Times</h4>
          <p>Today's schedule</p>
          <a href="{% url 'prayer:times' %}" class="btn btn-custom">View Times</a>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- Quick Actions Section End -->

<!-- Upcoming Events Section Start -->
<section class="py-5 bg-light">
  <div class="container">
    <h2 class="display-4 text-center mb-5">Upcoming <span class="text-custom">Events</span></h2>
    {% for event in upcoming_events|slice:":3" %}
    <div class="row align-items-center mb-4">
      <!-- Event Date -->
      <div class="col-md-3">
        <div class="border-end pe-3">
          <h6>{{ event.date|date:"d M Y" }}</h6>
          <p class="mb-0">{{ event.date|date:"D H:i" }}</p>
        </div>
      </div>
      <!-- Event Details -->
      <div class="col-md-6">
        <h4>{{ event.title }}</h4>
        <p>{{ event.description|truncatechars:150 }}</p>
        <a href="{% url 'events:event-detail' event.id %}" class="btn btn-custom">Details</a>
      </div>
      <!-- Event Image -->
      <div class="col-md-3">
        <img src="{{ event.featured_image.url }}" alt="{{ event.title }}" class="img-fluid rounded" />
      </div>
    </div>
    {% endfor %}
  </div>
</section>
<!-- Upcoming Events Section End -->

<!-- Charity Campaigns Section Start -->
<section class="py-5">
  <div class="container">
    <h2 class="display-4 text-center mb-5">Current <span class="text-custom">Campaigns</span></h2>
    <div class="row">
      {% for campaign in active_campaigns %}
      <div class="col-md-6 col-lg-4 mb-4">
        <div class="p-4 border rounded shadow-sm">
          <i class="fas fa-donate fa-3x mb-3" style="color: #2A5A3B;"></i>
          <h4>{{ campaign.name }}</h4>
          <!-- Progress bar with percentage -->
          <div class="progress my-3" style="height: 25px;">
            <div class="progress-bar bg-custom" role="progressbar" style="width: {{ campaign.percentage }}%;" aria-valuenow="{{ campaign.percentage }}" aria-valuemin="0" aria-valuemax="100">
              {{ campaign.percentage }}%
            </div>
          </div>
          <p>Raised £{{ campaign.current_amount|intcomma }} of £{{ campaign.target|intcomma }}</p>
          <a href="{% url 'charity:campaign-detail' campaign.id %}" class="btn btn-custom">Donate Now</a>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</section>
<!-- Charity Campaigns Section End -->

<!-- Prayer Times Section Start -->
<section class="py-5 bg-light">
  <div class="container">
    <h2 class="display-4 text-center mb-5">Today's <span class="text-custom">Prayer Times</span></h2>
    <div class="row g-4 justify-content-center">
      {% for name, time in prayer_times.items %}
      <div class="col-md-4">
        <div class="p-4 border rounded text-center">
          <h5 class="text-primary">{{ name|title }}</h5>
          <p class="mb-0">{{ time|time:"g:i a" }}</p>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</section>
<!-- Prayer Times Section End -->
{% endblock %}

{% block extra_css %}
<style>
  /* Additional styles specific to the members page */
  .text-custom {
    color: #C19A6B; /* Warm gold tone */
  }
  .bg-custom {
    background-color: #C19A6B; /* Warm gold background for buttons and progress bars */
  }
</style>
{% endblock %}

{% block extra_js %}
<script>
  // Hide the spinner once the page has fully loaded

</script>
{% endblock %}
